!function(){"use strict";function a(){EventEmitter2.apply(this),this.ros=new ROSLIB.Ros,this.ros.on("connection",this.onConnection.bind(this)),this.ros.on("close",this.onClose.bind(this)),this.ros.on("error",this.onError.bind(this)),this.on("status",function(a){switch(a){case"closed":setTimeout(this.connect.bind(this),d)}}),this.connect(),this.ed=new Ed(this),this.hardware=new Hardware(this)}var b="localhost",c="ws://"+b+":9090",d=5e3;a.prototype=Object.create(EventEmitter2.prototype),Object.defineProperty(a.prototype,"status",{get:function(){return this._status},set:function(a){this._status=a,this.emit("status",a)}}),a.prototype.connect=function(){console.log("connecting to "+c),this.ros.connect(c),this.status="connecting"},a.prototype.onConnection=function(){console.log("connection"),this.status="connected"},a.prototype.onClose=function(){console.log("connection closed"),this.status="closed"},a.prototype.onError=function(){this.status="error"},window.Robot=a}(),function(){"use strict";function a(a){EventEmitter2.apply(this);var b=a.ros;this.status=[],this.status_topic=b.Topic({name:"hardware_status",messageType:"diagnostic_msgs/DiagnosticArray",throttle_rate:500}),this.status_topic.subscribe(this.onStatus.bind(this)),this.models=[]}function b(a){var b=a.status.map(function(a){return{name:a.name,level:a.level,homed:"homed"===a.message}}),d=_.indexBy(b,"name");return _.defaults(d,g),_.mapValues(d,function(a){return a.actions=c(a),a}),d}function c(a){var b=e[a.name];if(b){var c=a?a.level:-1,f=a?a.homed:!1,g={};return b.homeable&&(g.home={enabled:c===d.IDLE,warning:f?"This part was already homed, Are you sure you want to redo homing?":!1}),g.start={enabled:c===d.IDLE&&(f||!b.homeable_mandatory),warning:b.homeable&&!f?"This part is not yet homed, Are you sure you want to proceed?":!1},g.stop={enabled:c===d.HOMING||c===d.OPERATIONAL},b.resetable&&(g.reset={enabled:c===d.ERROR}),g}}var d={STALE:0,IDLE:1,OPERATIONAL:2,HOMING:3,ERROR:4},e={all:[!0,!1,!0],base:[!1,!1,!0],spindle:[!0,!0,!0],left_arm:[!0,!1,!0],right_arm:[!0,!1,!0],head:[!1,!1,!1]};e=_.mapValues(e,function(a){return{homeable:a[0],homeable_mandatory:a[1],resetable:a[2]}});var f={all:0,base:1,spindle:2,left_arm:3,right_arm:4,head:5},g=_.mapValues(f,function(a,b){return{name:b,level:d.STALE,homed:!1}});a.prototype=Object.create(EventEmitter2.prototype),Object.defineProperty(a.prototype,"status",{get:function(){return this._status},set:function(a){this._status=a,this.emit("status",a)}}),a.prototype.onStatus=function(a){this.status=b(a)},window.Hardware=a}(),function(){"use strict";function a(a){EventEmitter2.apply(this);var d=a.ros;this.entities=[],this.entities_topic=d.Topic({name:b,messageType:"ed_gui_server/EntityInfos",throttle_rate:5e3}),this.snapshots={},this.snapshot_reision=0,this.snapshot_service=d.Service({name:c,serviceType:"ed_sensor_integration/GetSnapshots"}),this.models=[]}var b="ed/gui/entities",c="ed/gui/get_snapshots";a.prototype=Object.create(EventEmitter2.prototype),Object.defineProperty(a.prototype,"entities",{get:function(){return this._entities},set:function(a){this._entities=a,this.emit("entities",a)}}),a.prototype.onEntities=function(a){console.log(a),this.entities=a.entities},a.prototype.update_snapshots=function(){var a={revision:this.snapshot_revision};this.snapshot_service.callService(a,function(a){this.snapshot_revision=a.new_revision,a.image_ids.forEach(function(b,c){var d=a.images[c],e=d.encoding;d.src="data:image/"+e+";base64,"+d.data,d.short_id=_.trunc(b,{length:8,omission:""}),this.snapshots[b]=d}.bind(this)),this.emit("snapshots",this.snapshots)}.bind(this))},Object.defineProperty(a.prototype,"models",{get:function(){return this._models},set:function(a){this._models=a,this.emit("models",a)}}),a.prototype.updateModels=function(){this.models=[{name:"Coke",src:"images/coca-cola.d00da17c.jpg"},{name:"Fanta",src:"images/coca-cola.d00da17c.jpg"},{name:"d7f7",src:"images/coca-cola.d00da17c.jpg"},{name:"32",src:"images/coca-cola.d00da17c.jpg"},{name:"d73f7",src:"images/coca-cola.d00da17c.jpg"},{name:"d7f27",src:"images/coca-cola.d00da17c.jpg"},{name:"d3217f7",src:"images/coca-cola.d00da17c.jpg"},{name:"d73f7",src:"images/coca-cola.d00da17c.jpg"},{name:"d7f7",src:"images/coca-cola.d00da17c.jpg"},{name:"d7f2317",src:"images/coca-cola.d00da17c.jpg"},{name:"d7321f7",src:"images/coca-cola.d00da17c.jpg"},{name:"d3213127f7",src:"images/coca-cola.d00da17c.jpg"},{name:"d7312f7",src:"images/coca-cola.d00da17c.jpg"},{name:"d7312f7",src:"images/coca-cola.d00da17c.jpg"},{name:"d7312f7",src:"images/coca-cola.d00da17c.jpg"},{name:"d317f7",src:"images/coca-cola.d00da17c.jpg"}]},window.Ed=a}(),angular.module("challengeOpenApp",["ngAnimate","ngTouch"]),angular.module("challengeOpenApp").controller("MainCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("challengeOpenApp").provider("robot",function(){this.setUrl=function(a){this.url=a},this.$get=function(){var a=window.r=new Robot;return a}}),angular.module("challengeOpenApp").controller("ConnectionCtrl",["$scope","robot",function(a,b){a.connection=b.status,b.on("status",function(b){console.log("new status",b),a.$apply(function(){a.connection=b})})}]),angular.module("challengeOpenApp").controller("ModellistCtrl",["$scope","robot",function(a,b){b.ed.updateModels(),a.models=b.ed.models,b.ed.on("models",function(b){a.$apply(function(){a.models=b})})}]),angular.module("challengeOpenApp").controller("SnapshotlistCtrl",["robot","$scope",function(a,b){b.snapshots=a.ed.snapshots,b.snapshots=a.ed.update_snapshots(),b.select=function(a){b.selected=a},a.ed.on("snapshots",function(a){b.$apply(function(){b.snapshots=a})})}]),angular.module("challengeOpenApp").controller("SnapshotlabelerCtrl",["$scope",function(a){}]),angular.module("challengeOpenApp").controller("TriggerCtrl",["$scope","robot",function(a,b){var c=b.ros.Topic({name:"trigger",messageType:"std_msgs/String"});a.trigger=function(a){c.publish({data:a})}}]),angular.module("challengeOpenApp").run(["$templateCache",function(a){"use strict";a.put("views/main.html",'<div class="container-fluid entity-editor" ng-controller="SnapshotlistCtrl"> <div class="row entity-labeler" ng-controller="SnapshotlabelerCtrl"> <div class="col-xs-9 rgbd-image" ng-style="{ \'background-image\': \'url(\'+snapshots[selected].src+\')\' }"> </div> <div class="col-xs-3 model-view"> <div class="model-view-image"> <img class="img-responsive entity-image" src="images/yeoman.8cb970fb.png"> </div> <div class="model-view-table"> <table class="table"> <tbody> <tr> <th scope="row">UUID: </th> <td>Banana</td> </tr> <tr> <th scope="row">Name: </th> <td>Otto</td> </tr> <tr> <th scope="row">Name: </th> <td>Otto</td> </tr> </tbody> </table> </div> </div> </div> <div class="row model-db scrollable"> <button ng-repeat="(id, snapshot) in snapshots" type="button" class="btn btn-lg" ng-class="{ \'btn-primary\': selected == id, \'btn-default\': selected != id }" ng-click="select(id)"> {{snapshot.short_id}} <img class="img-responsive" src="{{snapshot.src}}"> </button> </div> </div>')}]);